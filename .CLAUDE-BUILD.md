# A2P Service - Development Instructions

## What Exists
- /lib/svc_scaffold/ - Complete scaffold (Step 0)
  - Settings, logging, DI container, health endpoint
  - Import and reuse: from svc_scaffold import create_app, load_settings, get_logger, container
- CLAUDE.md - Core rules (ALWAYS follow)
- .env - Configuration (use existing)

## Next Steps Pattern
When implementing ANY new step:

1. **Check First**
Read /lib/svc_scaffold/
reuse everything possible
Check existing patterns in codebase
Import, don't recreate

2. **New Components**
/lib/svc_<step_name>/     # New step folder
/tests/tests_<step_name>/   # Step tests

3. **Integration Rules**
Use existing DI container (register new services)
Use existing logger factory (don't create new)
Use existing settings (extend AppSettings if needed)
Use existing app factory (add routers to it)

4. **Every Step Must**
Return standard envelopes: {phase, completion, message, source, metadata}
Have acceptance criteria before coding
Add Makefile targets if needed
Keep tests isolated per step

5. **Stack (Python)**
Defaults: Rate limit (slowapi), CORS, 30s timeouts, health checks

6. **Envelopes**
Request[T]: data, metadata, idempotency_key, timestamp
Response[T]: data, error, metadata, request_id, timestamp
Event[T]: event_type, data, event_id, idempotency_key, timestamp, metadata
Error: code, message, details

## technology
Next.js + javascript + tailwind.css + shadcn/ui + clerk.dev + Prisma + Postgresql + Stripe Payments + Redis
